{% extends 'base.html' %} {% load static %} {% block title %}Eliminar Post - Red
Social{% endblock %} {% block extra_css %}
<style>
  .delete-container {
    max-width: 500px;
    margin: 0 auto;
    padding: 20px;
    min-height: calc(100vh - 100px);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .delete-card {
    background: white;
    border: 2px solid #ffebee;
    border-radius: 12px;
    padding: 40px 30px;
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
    text-align: center;
  }

  .delete-icon {
    font-size: 64px;
    margin-bottom: 20px;
  }

  .delete-title {
    font-size: 24px;
    font-weight: bold;
    color: #d32f2f;
    margin-bottom: 15px;
  }

  .delete-message {
    color: #666;
    font-size: 16px;
    line-height: 1.6;
    margin-bottom: 30px;
  }

  .post-preview {
    background: #f9f9f9;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 30px;
    border-left: 4px solid #ffebee;
  }

  .post-preview-text {
    color: #666;
    font-size: 14px;
    font-style: italic;
  }

  .warning-info {
    background: #fff3cd;
    border: 1px solid #ffc107;
    color: #856404;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 30px;
    font-size: 13px;
  }

  .warning-info strong {
    display: block;
    margin-bottom: 8px;
  }

  .action-buttons {
    display: flex;
    gap: 15px;
    justify-content: center;
  }

  .btn {
    padding: 12px 32px;
    border: none;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    text-decoration: none;
    display: inline-flex;
    align-items: center;
    gap: 8px;
  }

  .btn-cancel {
    background: #f0f0f0;
    color: #333;
    flex: 1;
    justify-content: center;
  }

  .btn-cancel:hover {
    background: #e0e0e0;
  }

  .btn-delete {
    background: #d32f2f;
    color: white;
    flex: 1;
    justify-content: center;
  }

  .btn-delete:hover {
    background: #b71c1c;
  }

  .btn-delete:active {
    transform: scale(0.98);
  }

  .loading {
    display: none;
    text-align: center;
  }

  .spinner {
    display: inline-block;
    width: 20px;
    height: 20px;
    border: 3px solid #f3f3f3;
    border-top: 3px solid #d32f2f;
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }

  @keyframes spin {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }
</style>
{% endblock %} {% block content %}
<div class="delete-container">
  <div class="delete-card">
    <div class="delete-icon">üóëÔ∏è</div>
    <h1 class="delete-title">¬øEliminar Post?</h1>

    <div class="delete-message">
      Est√°s a punto de <strong>eliminar permanentemente</strong> este post. Esta
      acci√≥n no se puede deshacer.
    </div>

    <div class="post-preview">
      <div class="post-preview-text">"{{ post.content|truncatewords:20 }}"</div>
    </div>

    <div class="warning-info">
      <strong>‚ö†Ô∏è Advertencia</strong>
      Se eliminar√°n tambi√©n:
      <ul style="margin: 10px 0 0 0; padding-left: 20px">
        <li>{{ post.get_comment_count }} comentario(s)</li>
        <li>{{ post.get_like_count }} like(s)</li>
      </ul>
    </div>

    <div class="action-buttons">
      <a href="{% url 'post:detalle' post.id %}" class="btn btn-cancel">
        ‚Üê Cancelar
      </a>
      <form id="deleteForm" method="POST" style="flex: 1">
        {% csrf_token %}
        <button type="submit" class="btn btn-delete" style="width: 100%">
          üóëÔ∏è Eliminar
        </button>
      </form>
    </div>

    <div class="loading" id="loadingIndicator" style="margin-top: 20px">
      <div class="spinner"></div>
      <p style="margin-top: 10px; color: #666">Eliminando post...</p>
    </div>
  </div>
</div>

<script>
  document
    .getElementById("deleteForm")
    .addEventListener("submit", async function (e) {
      e.preventDefault();

      document.querySelector(".action-buttons").style.display = "none";
      document.getElementById("loadingIndicator").style.display = "block";

      try {
        const response = await fetch('{% url "post:eliminar" post.id %}', {
          method: "POST",
          headers: {
            "X-CSRFToken": document.querySelector("[name=csrfmiddlewaretoken]")
              .value,
            "X-Requested-With": "XMLHttpRequest",
          },
        });

        const data = await response.json();

        if (data.success) {
          setTimeout(() => {
            window.location.href = '{% url "post:timeline" %}';
          }, 1500);
        } else {
          alert(data.error || "Error al eliminar el post");
          document.querySelector(".action-buttons").style.display = "flex";
          document.getElementById("loadingIndicator").style.display = "none";
        }
      } catch (error) {
        console.error("Error:", error);
        alert("Error de conexi√≥n");
        document.querySelector(".action-buttons").style.display = "flex";
        document.getElementById("loadingIndicator").style.display = "none";
      }
    });
</script>
{% endblock %}
